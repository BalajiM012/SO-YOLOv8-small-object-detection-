path\to\your_env\Scripts\activate
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

import torch
print(torch.cuda.is_available())
print(torch.cuda.get_device_name(0))

# YOLOv8X Training Script for 10 Epochs on GPU
from ultralytics import YOLO

# Load the YOLOv8X model
model = YOLO('yolov8x.pt')

# Train the model on PASCAL VOC 2012 dataset
results = model.train(
    data='voc2012.yaml',  # Path to dataset configuration file
    epochs=10,            # Number of epochs
    imgsz=640,            # Image size
    batch=16,             # Batch size (adjust based on GPU memory)
    device=0,             # GPU device (0 for first GPU)
    project='models/yolov8x_training', # Separate folder for training
    name='run1',          # Run name
    save=True,            # Save model checkpoints
    val=True,             # Validate during training
    plots=True            # Generate plots
)

print("Training completed!")
print(f"Results saved to: {results.save_dir}")

# Load the trained model for testing
trained_model = YOLO(f'{results.save_dir}/weights/best.pt')

# Perform validation on the saved model
val_results = trained_model.val(data='voc2012.yaml')
print("Testing completed!")
print(f"Validation results: mAP50={val_results.box.map50:.4f}, mAP50-95={val_results.box.map:.4f}")

